  <!--
  Copyright © 2025 JSN01000111
  Licensed for educational and personal use only.
  -->

  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CSS Playground</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/scroll/simplescrollbars.min.css">

  <style>
    /* Global Resets & Basics */
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background: #f4f4f4; /* Slightly off-white background */
      color: #333;
      display: flex;
      flex-direction: column;
      min-height: 100vh; /* Ensure body takes full viewport height */
    }

    /* Main Container for the Playground */
    .playground-container {
      display: flex;
      flex-direction: column; /* Always stack panels vertically */
      flex-grow: 1; /* Allow container to fill available height */
    }

    /* Editor Panels (HTML & CSS) */
    .editor-panel {
      display: flex;
      flex-direction: column;
      border-bottom: 1px solid #e0e0e0; /* Lighter border */
      background: #fff;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); /* Subtle shadow */
      flex: 1; /* All panels (including preview) initially share space equally */
    }

    /* Header for Editor Panels */
    .editor-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      background: #e9e9e9; /* Light grey header */
      font-weight: bold;
      color: #555;
      border-bottom: 1px solid #ddd;
    }

    /* Toggle Button for collapsing/expanding */
    .toggle-btn {
      font-size: 1.2em; /* Slightly larger arrow */
      cursor: pointer;
      background: none;
      border: none;
      padding: 0 5px; /* Adjust padding for better click area */
      color: #666;
      transition: transform 0.2s ease-in-out, color 0.2s ease;
    }

    .toggle-btn:hover {
      color: #007bff;
    }

    /* HTML Editor Specifics */
    /* When HTML panel is collapsed */
    .html-editor-panel.html-collapsed {
      overflow: hidden; /* Hide anything that overflows during transition */
      flex: 0 0 50px; /* Shrink to header height */
    }

    .html-editor-panel.html-collapsed .CodeMirror {
      height: 0 !important; /* Force CodeMirror height to 0 */
      min-height: 0 !important; /* Override any min-height */
      border: none !important; /* Remove border when collapsed */
      margin: 0 !important; /* Remove margins */
      padding: 0 !important; /* Remove padding */
    }

    .html-editor-panel.html-collapsed .CodeMirror-scroll {
      height: 0 !important; /* Ensure the scrollable area is also 0 */
      min-height: 0 !important;
      overflow: hidden !important;
    }

    /* Code Editor Specifics (applies to both HTML and CSS CodeMirror instances) */
    .CodeMirror {
      flex-grow: 1; /* Allow to fill available vertical space */
      min-height: 180px; /* Slightly reduce default min-height */
      border: 1px solid #ddd; /* Match your desired border */
      border-radius: 6px;
      overflow: hidden; /* Important for border-radius to work */
      margin: 10px; /* Space around the editor */
      font-size: 14px; /* Consistent font size */
      line-height: 1.5; /* Consistent line height */
      background: white; /* Ensure background is white */
      color: black; /* Ensure text is black */
    }

    /* No margin top if it's the first child after the header in panel */
    .editor-panel > .CodeMirror {
        margin-top: 0; /* Let editor-panel padding handle top spacing */
        margin-left: 15px; /* Match header padding */
        margin-right: 15px; /* Match header padding */
        margin-bottom: 15px; /* Space from bottom of panel */
    }

    /* Preview Panel */
    .preview-panel {
      flex-grow: 1; /* Take remaining vertical space */
      padding: 15px;
      background: #fff;
      border-bottom: 1px solid #e0e0e0; /* Consistent border */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); /* Shadow below it */
      display: flex;
      flex-direction: column;
      flex: 1; /* Share space equally with editors initially */
    }

    .preview-header {
      font-weight: bold;
      color: #555;
      margin-bottom: 10px;
    }

    .iframe-wrapper {
      position: relative;
      width: 100%;
      flex-grow: 1; /* Allow iframe wrapper to fill space */
      border: 1px solid #ccc;
      border-radius: 6px;
      overflow: hidden;
      background: #fff;
    }

    #preview-iframe {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    /* Responsive Adjustments - Simplified */
    /* All panels will naturally take 1/3 of the height when expanded */
    /* and preview/css will split remaining space when HTML is collapsed */

    /* When HTML is collapsed, CSS and Preview should take remaining space */
    .playground-container.html-is-collapsed .css-editor-panel {
        flex: 1; /* CSS takes 1 part */
    }
    .playground-container.html-is-collapsed .preview-panel {
        flex: 1.5; /* Preview takes 1.5 parts - giving it slightly more space */
    }


    /* General mobile adjustments - mostly padding and font sizes now */
    @media (max-width: 768px) {
      body {
        padding: 8px; /* Slightly less padding */
      }
      .editor-header {
        padding: 8px 12px;
      }
      .CodeMirror {
        font-size: 13px;
        min-height: 150px; /* Keep min-height reasonable on tablets */
      }
      .editor-panel > .CodeMirror {
          margin-left: 10px;
          margin-right: 10px;
          margin-bottom: 10px;
      }
      .html-editor-panel.html-collapsed .editor-header .toggle-btn {
        transform: rotate(0deg); /* Always vertical arrow for vertical collapse */
      }
       /* For very small screens, adjust min-height further */
       @media (max-height: 500px) { /* e.g., when keyboard is open or very small phone */
           .CodeMirror {
               min-height: 100px;
           }
       }
    }

    @media (max-width: 480px) {
      body {
        padding: 5px;
      }
      .CodeMirror {
        font-size: 12px;
        min-height: 120px; /* Adjusted min-height for small phones */
      }
      .editor-panel > .CodeMirror {
          margin-left: 5px;
          margin-right: 5px;
          margin-bottom: 5px;
      }
    }
  </style>
</head>
<body>
  <div class="playground-container">

    <div class="preview-panel">
      <div class="preview-header">Live Output</div> <div class="iframe-wrapper">
        <iframe id="preview-iframe"></iframe>
      </div>
    </div>

    <div class="editor-panel css-editor-panel" id="css-panel">
      <div class="editor-header">CSS</div>
      <textarea id="css-code" class="code-input" spellcheck="false">/* Your CSS goes here */
body {
  font-family: sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
  background-color: #f0f0f0;
}

h1 {
  color: #3498db;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
}

button {
  background-color: #2ecc71;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

button:hover {
  background-color: #27ae60;
}
      </textarea>
    </div>

    <div class="editor-panel html-editor-panel" id="html-panel">
      <div class="editor-header">
        HTML
        <button class="toggle-btn" id="html-toggle-btn">▼</button>
      </div>
      <textarea id="html-code" class="code-input" spellcheck="false">
        <h1>Hello CSS Playground!</h1>
        <button>Click Me</button>        
      </textarea>
    </div>

  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/xml/xml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/css/css.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/javascript/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/htmlmixed/htmlmixed.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/edit/closetag.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/edit/matchbrackets.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/scroll/simplescrollbars.min.js"></script>


  <script>
    // Get references to DOM elements
    const htmlCodeInput = document.getElementById("html-code");
    const cssCodeInput = document.getElementById("css-code");
    const previewIframe = document.getElementById("preview-iframe");
    const htmlPanel = document.getElementById("html-panel");
    const htmlToggleBtn = document.getElementById("html-toggle-btn");
    const cssPanel = document.getElementById("css-panel");
    const previewPanel = document.querySelector(".preview-panel");
    const playgroundContainer = document.querySelector(".playground-container");

    let htmlEditorCM; // Declare CodeMirror instances globally
    let cssEditorCM;

    // Function to update the live preview iframe
    function updatePreview() {
      const htmlContent = htmlEditorCM.getValue();
      const cssContent = cssEditorCM.getValue();

      const fullHtml = `
        <!DOCTYPE html>
        <html>
        <head>
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <style>
                body { /* Add this rule to the iframe's body */
                    margin: 0;
                    padding: 0;
                }
                ${cssContent}
            </style>
        </head>
        <body>
            ${htmlContent}
        </body>
        </html>
      `;
      previewIframe.contentWindow.document.open();
      previewIframe.contentWindow.document.write(fullHtml);
      previewIframe.contentWindow.document.close();
    }

    // Function to toggle HTML editor panel
    function toggleHtmlEditor() {
      const isCollapsed = htmlPanel.classList.toggle('html-collapsed');

      // Add/remove a class on the container to help with flex re-distribution
      playgroundContainer.classList.toggle('html-is-collapsed', isCollapsed);

      // The arrow will always point up/down now
      htmlToggleBtn.textContent = isCollapsed ? '▲' : '▼';

      // Use a brief timeout to allow CSS transitions to start
      setTimeout(() => {
        // Refresh CodeMirror instances after potential size changes
        htmlEditorCM.refresh();
        cssEditorCM.refresh();
      }, 50); // Small delay to allow CSS transitions
    }

    // Initial setup on page load
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize CodeMirror for HTML
      htmlEditorCM = CodeMirror.fromTextArea(htmlCodeInput, {
          mode: 'htmlmixed',
          lineNumbers: true,
          matchBrackets: true,
          autoCloseTags: true,
      });

      // Initialize CodeMirror for CSS
      cssEditorCM = CodeMirror.fromTextArea(cssCodeInput, {
          mode: 'css',
          lineNumbers: true,
          matchBrackets: true,
      });

      // Attach event listeners for CodeMirror changes to update preview
      htmlEditorCM.on('change', updatePreview);
      cssEditorCM.on('change', updatePreview);

      // Event listener for the toggle button
      htmlToggleBtn.addEventListener('click', toggleHtmlEditor);

      // Perform initial update of the preview
      updatePreview();

      // Collapse HTML editor on initial load
      toggleHtmlEditor(); // This will trigger the initial collapse and refresh   
      
    });
  </script>
</body>
</html>
